<ul id="catshowpage">
<% @array_of_events.each do |event| %>
<% if !event.deleted %>
<li><a href="/events/<%= event.id %>">
	<% if event.photo.file? %>
	<%= image_tag event.photo.url(:small), :width => 100 %>
	<% elsif event.facebooklink %>
	<img src="https://graph.facebook.com/<%= event.facebooklink%>/picture?type=normal" width="100"></img>
	<% else %>
	<%= image_tag ("bowl3.jpg"), :height => 70, :width => 100 %>
	<% end %>

<div id="eventwords">

	<div id="when">
	<% if event.date && event.time %>
	<b><%= @months[event.date.month - 1] %> <%= event.date.day %>, <%= event.date.year %> at <%= event.time.strftime("%I:%M %p")%> </b><br />
	<% end %>
	<i><%= event.description %></i> <br />
	<% if event.facebooklink%>
	<a href="http://www.facebook.com/event.php?eid=<%= event.facebooklink %>"><b>Link to Facebook Event</b></a>	
	<% end %>
	</div>
</div>
</a>
</li>
<% end %>
<% end %>
</ul>
<script type="text/javascript">
$(document).ready(function(){
	var from = 0, to = 5, step = 5, maxSize = <%= @array_of_events.size %>;
	
	function showNext(list) {
	  list.find('li:lt(' + (to) + '):not(li:lt(' + (to-step) + '))').fadeIn();
	  $("html, body").animate({ scrollTop: $(document).height()-$(window).height()}, 1000);
	  to+= step;
	  if(to >= maxSize){
	  	$('#more').hide();
	  	$('#back_to_top').show();
	  }
	}
	function start(list){
		list.find('li').hide().end().find('li:lt(' + (to) + '):not(li:lt(' + from + '))').show();
		
		if(to >= maxSize){
		  	$('#more').hide();
		  	$('#back_to_top').show();
	  }
	  to+= step;
	}
	start($('ul#catshowpage'));
	$('#more').click(function(e){
		e.preventDefault();
		showNext($('ul#catshowpage'));
	});
	$('#back_to_top').click(function(e){
		e.preventDefault();
		$("html, body").animate({ scrollTop: 0 }, 700);
	});
});
</script>
<% if @array_of_events.size > 5%>
<a href="#" id="more">More</a>
<a href='#' id="back_to_top">Back to Top</a>
<% end %>
