/*!
 * jCarousel - Riding carousels with jQuery
 *   http://sorgalla.com/jcarousel/
 *
 * Copyright (c) 2006 Jan Sorgalla (http://sorgalla.com)
 * Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
 * and GPL (http://www.opensource.org/licenses/gpl-license.php) licenses.
 *
 * Built on top of the jQuery library
 *   http://jquery.com
 *
 * Inspired by the "Carousel Component" by Bill Scott
 *   http://billwscott.com/carousel/
 */
(function(a){var b={vertical:!1,rtl:!1,start:1,offset:1,size:null,scroll:3,visible:null,animation:"normal",easing:"swing",auto:0,wrap:null,initCallback:null,setupCallback:null,reloadCallback:null,itemLoadCallback:null,itemFirstInCallback:null,itemFirstOutCallback:null,itemLastInCallback:null,itemLastOutCallback:null,itemVisibleInCallback:null,itemVisibleOutCallback:null,animationStepCallback:null,buttonNextHTML:"<div></div>",buttonPrevHTML:"<div></div>",buttonNextEvent:"click",buttonPrevEvent:"click",buttonNextCallback:null,buttonPrevCallback:null,itemFallbackDimension:null},c=!1;a(window).bind("load.jcarousel",function(){c=!0}),a.jcarousel=function(d,e){this.options=a.extend({},b,e||{}),this.autoStopped=this.locked=!1,this.buttonPrevState=this.buttonNextState=this.buttonPrev=this.buttonNext=this.list=this.clip=this.container=null;if(!e||e.rtl===void 0)this.options.rtl=(a(d).attr("dir")||a("html").attr("dir")||"").toLowerCase()=="rtl";this.wh=this.options.vertical?"height":"width",this.lt=this.options.vertical?"top":this.options.rtl?"right":"left";for(var f="",h=d.className.split(" "),i=0;i<h.length;i++)if(h[i].indexOf("jcarousel-skin")!=-1){a(d).removeClass(h[i]),f=h[i];break}d.nodeName.toUpperCase()=="UL"||d.nodeName.toUpperCase()=="OL"?(this.list=a(d),this.clip=this.list.parents(".jcarousel-clip"),this.container=this.list.parents(".jcarousel-container")):(this.container=a(d),this.list=this.container.find("ul,ol").eq(0),this.clip=this.container.find(".jcarousel-clip")),this.clip.size()===0&&(this.clip=this.list.wrap("<div></div>").parent()),this.container.size()===0&&(this.container=this.clip.wrap("<div></div>").parent()),f!==""&&this.container.parent()[0].className.indexOf("jcarousel-skin")==-1&&this.container.wrap('<div class=" '+f+'"></div>'),this.buttonPrev=a(".jcarousel-prev",this.container),this.buttonPrev.size()===0&&this.options.buttonPrevHTML!==null&&(this.buttonPrev=a(this.options.buttonPrevHTML).appendTo(this.container)),this.buttonPrev.addClass(this.className("jcarousel-prev")),this.buttonNext=a(".jcarousel-next",this.container),this.buttonNext.size()===0&&this.options.buttonNextHTML!==null&&(this.buttonNext=a(this.options.buttonNextHTML).appendTo(this.container)),this.buttonNext.addClass(this.className("jcarousel-next")),this.clip.addClass(this.className("jcarousel-clip")).css({position:"relative"}),this.list.addClass(this.className("jcarousel-list")).css({overflow:"hidden",position:"relative",top:0,margin:0,padding:0}).css(this.options.rtl?"right":"left",0),this.container.addClass(this.className("jcarousel-container")).css({position:"relative"}),!this.options.vertical&&this.options.rtl&&this.container.addClass("jcarousel-direction-rtl").attr("dir","rtl");var j=this.options.visible!==null?Math.ceil(this.clipping()/this.options.visible):null,f=this.list.children("li"),k=this;if(f.size()>0){var l=0,n=this.options.offset;f.each(function(){k.format(this,n++),l+=k.dimension(this,j)}),this.list.css(this.wh,l+100+"px");if(!e||e.size===void 0)this.options.size=f.size()}this.container.css("display","block"),this.buttonNext.css("display","block"),this.buttonPrev.css("display","block"),this.funcNext=function(){k.next()},this.funcPrev=function(){k.prev()},this.funcResize=function(){k.resizeTimer&&clearTimeout(k.resizeTimer),k.resizeTimer=setTimeout(function(){k.reload()},100)},this.options.initCallback!==null&&this.options.initCallback(this,"init"),!c&&a.browser.safari?(this.buttons(!1,!1),a(window).bind("load.jcarousel",function(){k.setup()})):this.setup()};var d=a.jcarousel;d.fn=d.prototype={jcarousel:"0.2.8"},d.fn.extend=d.extend=a.extend,d.fn.extend({setup:function(){this.prevLast=this.prevFirst=this.last=this.first=null,this.animating=!1,this.tail=this.resizeTimer=this.timer=null,this.inTail=!1;if(!this.locked){this.list.css(this.lt,this.pos(this.options.offset)+"px");var b=this.pos(this.options.start,!0);this.prevFirst=this.prevLast=null,this.animate(b,!1),a(window).unbind("resize.jcarousel",this.funcResize).bind("resize.jcarousel",this.funcResize),this.options.setupCallback!==null&&this.options.setupCallback(this)}},reset:function(){this.list.empty(),this.list.css(this.lt,"0px"),this.list.css(this.wh,"10px"),this.options.initCallback!==null&&this.options.initCallback(this,"reset"),this.setup()},reload:function(){this.tail!==null&&this.inTail&&this.list.css(this.lt,d.intval(this.list.css(this.lt))+this.tail),this.tail=null,this.inTail=!1,this.options.reloadCallback!==null&&this.options.reloadCallback(this);if(this.options.visible!==null){var a=this,b=Math.ceil(this.clipping()/this.options.visible),c=0,e=0;this.list.children("li").each(function(d){c+=a.dimension(this,b),d+1<a.first&&(e=c)}),this.list.css(this.wh,c+"px"),this.list.css(this.lt,-e+"px")}this.scroll(this.first,!1)},lock:function(){this.locked=!0,this.buttons()},unlock:function(){this.locked=!1,this.buttons()},size:function(a){return a!==void 0&&(this.options.size=a,this.locked||this.buttons()),this.options.size},has:function(a,b){if(b===void 0||!b)b=a;this.options.size!==null&&b>this.options.size&&(b=this.options.size);for(var c=a;c<=b;c++){var d=this.get(c);if(!d.length||d.hasClass("jcarousel-item-placeholder"))return!1}return!0},get:function(b){return a(">.jcarousel-item-"+b,this.list)},add:function(b,c){var e=this.get(b),h=0,i=a(c);if(e.length===0){for(var j,k=d.intval(b),e=this.create(b);;)if(j=this.get(--k),k<=0||j.length){k<=0?this.list.prepend(e):j.after(e);break}}else h=this.dimension(e);return i.get(0).nodeName.toUpperCase()=="LI"?(e.replaceWith(i),e=i):e.empty().append(c),this.format(e.removeClass(this.className("jcarousel-item-placeholder")),b),i=this.options.visible!==null?Math.ceil(this.clipping()/this.options.visible):null,h=this.dimension(e,i)-h,b>0&&b<this.first&&this.list.css(this.lt,d.intval(this.list.css(this.lt))-h+"px"),this.list.css(this.wh,d.intval(this.list.css(this.wh))+h+"px"),e},remove:function(a){var b=this.get(a);if(b.length&&!(a>=this.first&&a<=this.last)){var c=this.dimension(b);a<this.first&&this.list.css(this.lt,d.intval(this.list.css(this.lt))+c+"px"),b.remove(),this.list.css(this.wh,d.intval(this.list.css(this.wh))-c+"px")}},next:function(){this.tail!==null&&!this.inTail?this.scrollTail(!1):this.scroll(this.options.wrap!="both"&&this.options.wrap!="last"||this.options.size===null||this.last!=this.options.size?this.first+this.options.scroll:1)},prev:function(){this.tail!==null&&this.inTail?this.scrollTail(!0):this.scroll(this.options.wrap!="both"&&this.options.wrap!="first"||this.options.size===null||this.first!=1?this.first-this.options.scroll:this.options.size)},scrollTail:function(a){if(!this.locked&&!this.animating&&this.tail){this.pauseAuto();var b=d.intval(this.list.css(this.lt)),b=a?b+this.tail:b-this.tail;this.inTail=!a,this.prevFirst=this.first,this.prevLast=this.last,this.animate(b)}},scroll:function(a,b){!this.locked&&!this.animating&&(this.pauseAuto(),this.animate(this.pos(a),b))},pos:function(a,b){var c=d.intval(this.list.css(this.lt));if(this.locked||this.animating)return c;this.options.wrap!="circular"&&(a=a<1?1:this.options.size&&a>this.options.size?this.options.size:a);for(var e=this.first>a,g=this.options.wrap!="circular"&&this.first<=1?1:this.first,h=e?this.get(g):this.get(this.last),i=e?g:g-1,j=null,k=0,l=!1,m=0;e?--i>=a:++i<a;)j=this.get(i),l=!j.length,j.length===0&&(j=this.create(i).addClass(this.className("jcarousel-item-placeholder")),h[e?"before":"after"](j),this.first!==null&&this.options.wrap=="circular"&&this.options.size!==null&&(i<=0||i>this.options.size))&&(h=this.get(this.index(i)),h.length&&(j=this.add(i,h.clone(!0)))),h=j,m=this.dimension(j),l&&(k+=m),this.first!==null&&(this.options.wrap=="circular"||i>=1&&(this.options.size===null||i<=this.options.size))&&(c=e?c+m:c-m);for(var g=this.clipping(),n=[],o=0,p=0,h=this.get(a-1),i=a;++o;){j=this.get(i),l=!j.length,j.length===0&&(j=this.create(i).addClass(this.className("jcarousel-item-placeholder")),h.length===0?this.list.prepend(j):h[e?"before":"after"](j),this.first!==null&&this.options.wrap=="circular"&&this.options.size!==null&&(i<=0||i>this.options.size)&&(h=this.get(this.index(i)),h.length&&(j=this.add(i,h.clone(!0))))),h=j,m=this.dimension(j);if(m===0)throw Error("jCarousel: No width/height set for items. This will cause an infinite loop. Aborting...");this.options.wrap!="circular"&&this.options.size!==null&&i>this.options.size?n.push(j):l&&(k+=m),p+=m;if(p>=g)break;i++}for(j=0;j<n.length;j++)n[j].remove();k>0&&(this.list.css(this.wh,this.dimension(this.list)+k+"px"),e&&(c-=k,this.list.css(this.lt,d.intval(this.list.css(this.lt))-k+"px"))),k=a+o-1,this.options.wrap!="circular"&&this.options.size&&k>this.options.size&&(k=this.options.size);if(i>k){o=0,i=k;for(p=0;++o;){j=this.get(i--);if(!j.length)break;p+=this.dimension(j);if(p>=g)break}}i=k-o+1,this.options.wrap!="circular"&&i<1&&(i=1),this.inTail&&e&&(c+=this.tail,this.inTail=!1),this.tail=null,this.options.wrap!="circular"&&k==this.options.size&&k-o+1>=1&&(e=d.intval(this.get(k).css(this.options.vertical?"marginBottom":"marginRight")),p-e>g)&&(this.tail=p-g-e),b&&a===this.options.size&&this.tail&&(c-=this.tail,this.inTail=!0);for(;a-->i;)c+=this.dimension(this.get(a));return this.prevFirst=this.first,this.prevLast=this.last,this.first=i,this.last=k,c},animate:function(b,c){if(!this.locked&&!this.animating){this.animating=!0;var d=this,e=function(){d.animating=!1,b===0&&d.list.css(d.lt,0),!d.autoStopped&&(d.options.wrap=="circular"||d.options.wrap=="both"||d.options.wrap=="last"||d.options.size===null||d.last<d.options.size||d.last==d.options.size&&d.tail!==null&&!d.inTail)&&d.startAuto(),d.buttons(),d.notify("onAfterAnimation");if(d.options.wrap=="circular"&&d.options.size!==null)for(var a=d.prevFirst;a<=d.prevLast;a++)a!==null&&!(a>=d.first&&a<=d.last)&&(a<1||a>d.options.size)&&d.remove(a)};this.notify("onBeforeAnimation");if(!this.options.animation||c===!1)this.list.css(this.lt,b+"px"),e();else{var f=this.options.vertical?{top:b}:this.options.rtl?{right:b}:{left:b},e={duration:this.options.animation,easing:this.options.easing,complete:e};a.isFunction(this.options.animationStepCallback)&&(e.step=this.options.animationStepCallback),this.list.animate(f,e)}}},startAuto:function(a){a!==void 0&&(this.options.auto=a);if(this.options.auto===0)return this.stopAuto();if(this.timer===null){this.autoStopped=!1;var b=this;this.timer=window.setTimeout(function(){b.next()},this.options.auto*1e3)}},stopAuto:function(){this.pauseAuto(),this.autoStopped=!0},pauseAuto:function(){this.timer!==null&&(window.clearTimeout(this.timer),this.timer=null)},buttons:function(a,b){a==null&&(a=!this.locked&&this.options.size!==0&&(this.options.wrap&&this.options.wrap!="first"||this.options.size===null||this.last<this.options.size),!this.locked&&(!this.options.wrap||this.options.wrap=="first")&&this.options.size!==null&&this.last>=this.options.size)&&(a=this.tail!==null&&!this.inTail),b==null&&(b=!this.locked&&this.options.size!==0&&(this.options.wrap&&this.options.wrap!="last"||this.first>1),!this.locked&&(!this.options.wrap||this.options.wrap=="last")&&this.options.size!==null&&this.first==1)&&(b=this.tail!==null&&this.inTail);var c=this;this.buttonNext.size()>0?(this.buttonNext.unbind(this.options.buttonNextEvent+".jcarousel",this.funcNext),a&&this.buttonNext.bind(this.options.buttonNextEvent+".jcarousel",this.funcNext),this.buttonNext[a?"removeClass":"addClass"](this.className("jcarousel-next-disabled")).attr("disabled",a?!1:!0),this.options.buttonNextCallback!==null&&this.buttonNext.data("jcarouselstate")!=a&&this.buttonNext.each(function(){c.options.buttonNextCallback(c,this,a)}).data("jcarouselstate",a)):this.options.buttonNextCallback!==null&&this.buttonNextState!=a&&this.options.buttonNextCallback(c,null,a),this.buttonPrev.size()>0?(this.buttonPrev.unbind(this.options.buttonPrevEvent+".jcarousel",this.funcPrev),b&&this.buttonPrev.bind(this.options.buttonPrevEvent+".jcarousel",this.funcPrev),this.buttonPrev[b?"removeClass":"addClass"](this.className("jcarousel-prev-disabled")).attr("disabled",b?!1:!0),this.options.buttonPrevCallback!==null&&this.buttonPrev.data("jcarouselstate")!=b&&this.buttonPrev.each(function(){c.options.buttonPrevCallback(c,this,b)}).data("jcarouselstate",b)):this.options.buttonPrevCallback!==null&&this.buttonPrevState!=b&&this.options.buttonPrevCallback(c,null,b),this.buttonNextState=a,this.buttonPrevState=b},notify:function(a){var b=this.prevFirst===null?"init":this.prevFirst<this.first?"next":"prev";this.callback("itemLoadCallback",a,b),this.prevFirst!==this.first&&(this.callback("itemFirstInCallback",a,b,this.first),this.callback("itemFirstOutCallback",a,b,this.prevFirst)),this.prevLast!==this.last&&(this.callback("itemLastInCallback",a,b,this.last),this.callback("itemLastOutCallback",a,b,this.prevLast)),this.callback("itemVisibleInCallback",a,b,this.first,this.last,this.prevFirst,this.prevLast),this.callback("itemVisibleOutCallback",a,b,this.prevFirst,this.prevLast,this.first,this.last)},callback:function(b,c,d,e,f,h,i){if(this.options[b]!=null&&(typeof this.options[b]=="object"||c=="onAfterAnimation")){var j=typeof this.options[b]=="object"?this.options[b][c]:this.options[b];if(a.isFunction(j)){var k=this;if(e===void 0)j(k,d,c);else if(f===void 0)this.get(e).each(function(){j(k,this,e,d,c)});else for(var b=function(a){k.get(a).each(function(){j(k,this,a,d,c)})},l=e;l<=f;l++)l!==null&&!(l>=h&&l<=i)&&b(l)}}},create:function(a){return this.format("<li></li>",a)},format:function(b,c){for(var b=a(b),d=b.get(0).className.split(" "),e=0;e<d.length;e++)d[e].indexOf("jcarousel-")!=-1&&b.removeClass(d[e]);return b.addClass(this.className("jcarousel-item")).addClass(this.className("jcarousel-item-"+c)).css({"float":this.options.rtl?"right":"left","list-style":"none"}).attr("jcarouselindex",c),b},className:function(a){return a+" "+a+(this.options.vertical?"-vertical":"-horizontal")},dimension:function(b,c){var e=a(b);if(c==null)return this.options.vertical?e.outerHeight(!0)||d.intval(this.options.itemFallbackDimension):e.outerWidth(!0)||d.intval(this.options.itemFallbackDimension);var h=this.options.vertical?c-d.intval(e.css("marginTop"))-d.intval(e.css("marginBottom")):c-d.intval(e.css("marginLeft"))-d.intval(e.css("marginRight"));return a(e).css(this.wh,h+"px"),this.dimension(e)},clipping:function(){return this.options.vertical?this.clip[0].offsetHeight-d.intval(this.clip.css("borderTopWidth"))-d.intval(this.clip.css("borderBottomWidth")):this.clip[0].offsetWidth-d.intval(this.clip.css("borderLeftWidth"))-d.intval(this.clip.css("borderRightWidth"))},index:function(a,b){return b==null&&(b=this.options.size),Math.round(((a-1)/b-Math.floor((a-1)/b))*b)+1}}),d.extend({defaults:function(c){return a.extend(b,c||{})},intval:function(a){return a=parseInt(a,10),isNaN(a)?0:a},windowLoaded:function(){c=!0}}),a.fn.jcarousel=function(b){if(typeof b=="string"){var c=a(this).data("jcarousel"),e=Array.prototype.slice.call(arguments,1);return c[b].apply(c,e)}return this.each(function(){var c=a(this).data("jcarousel");c?(b&&a.extend(c.options,b),c.reload()):a(this).data("jcarousel",new d(this,b))})}})(jQuery);